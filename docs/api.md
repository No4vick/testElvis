# Инструкция по использованию API

Данное API предоставляет методы для управления пользователями, достижениями и статистикой. Ниже описаны доступные эндпоинты.

## Общие сведения

- **Базовый URL**: `/`

## Эндпоинты

### Создать пользователя

- **URL**: `/user`
- **Метод**: `POST`
- **Описание**: Создает нового пользователя.

**Тело запроса**:

```json
{
    "username": "string",
    "language": "EN"  // Также доступен RU
}
```

**Ответ**:

```json
{
    "id": 1
}
```

#### Пример

**Запрос**
```json
{
    "username": "Alice",
    "language": "RU"  // Также доступен RU
}
```

**Ответ**:

```json
{
    "id": 10
}
```

---

### Получить информацию о пользователе

- **URL**: `/user/{user_id}`
- **Метод**: `GET`
- **Описание**: Возвращает полную информацию о пользователе.

**Параметры пути**:

- `user_id` - ID пользователя

**Ответ**:

```json
{
    "id": 1,
    "username": "string",
    "language": "EN",
    "total_score": 100,
    "achievements": [/* список достижений */]
}
```
#### Пример
**Запрос** `GET` по ссылке `http://your_url/user/10` 

**Ответ**
```json
{
    "id": 10,
    "username": "Alice",
    "language": "RU",
    "total_score": 100,
    "achievements": [
        {
            "id": 1,
            "score": 50,
            "translation": {
                "language": "RU",
                "title": "Билетчик I",
                "description": "Выполнить 10 тикетов"
            }
        },
        {
            "id": 15,
            "score": 50,
            "translation": {
                "language": "RU",
                "title": "Дойти до кухни",
                "description": "Пройти 500 метров"
            }
        }
    ]
}
```

---

### Создать достижение

- **URL**: `/achievement`
- **Метод**: `POST`
- **Описание**: Создает новое достижение.

**Тело запроса**:

```json
{
    "score": 50,
    "translations": [
        {
            "language": "EN",
            "title": "Achievement Title",
            "description": "Achievement Description"
        }
        // другие переводы
    ]
}
```

**Ответ**:

```json
{
    "id": 1,
    "score": 50
}
```

#### Пример
**Запрос**
```json
{
    "score": 25,
    "translations": [
        {
            "language": "EN",
            "title": "No! I have written it somewhere...",
            "description": "Reset your password for the first time"
        },
        {
            "language": "RU",
            "title": "Нет! У меня он где-то записан...",
            "description": "Впервые сбросить свой пароль"
        },
    ]
}
```

**Ответ**:

```json
{
    "id": 16,
    "score": 25
}
```

---

### Получить достижение

- **URL**: `/achievement/{achievement_id}`
- **Метод**: `GET`
- **Описание**: Получает информацию о достижении.

**Параметры пути**:

- `achievement_id` - ID достижения

**Параметры запроса**:

- `language` (необязательный) - язык перевода

**Ответ**:

```json
{
    "id": 1,
    "score": 50,
    "translation": {
        "language": "EN",
        "title": "Achievement Title",
        "description": "Achievement Description"
    }
}
```
#### Пример
**Запрос** `GET` по ссылке `http://your_url/achievement/18` 

**Ответ**
```json
{
    "id": 18,
    "score": 100,
    "translation": {
        "language": "EN",
        "title": "Thy Favourite",
        "description": "Buy the same menu item 50 times"
    }
}
```


---

### Обновить перевод достижения

- **URL**: `/achievement/translate/{achievement_id}`
- **Метод**: `PUT`
- **Описание**: Обновляет перевод достижения на заданном языке. Также может использоваться и для добавления переводаю

**Параметры пути**:

- `achievement_id` - ID достижения

**Тело запроса**:

```json
{
    "language": "EN",
    "title": "Updated Title",
    "description": "Updated Description"
}
```

**Ответ**

Пустой, со статусом `200`

#### Пример
**Запрос** `PUT` по ссылке `http://your_url/achievement/translate/1`
 ```json
{
    "language": "EN",
    "title": "Ticketmaster I",
    "description": "Complete 10 tickets"
}
```

**Ответ**

`status = 200`

---

### Выдать достижение пользователю

- **URL**: `/achievement/grant`
- **Метод**: `POST`
- **Описание**: Выдаёт достижение пользователю. Если не указывать `datetime`, то время выдачи будет считаться моментом обработки запроса.

**Тело запроса**:

```json
{
    "user_id": 1,
    "achievement_id": 1,
    "datetime": "2023-01-01T12:00:00"  // необязательное поле
}
```

**Ответ**

Пустой, со статусом `200`

#### Пример
**Запрос** `PUT` по ссылке `http://your_url/achievement/translate/1`
```json
{
    "user_id": 10,
    "achievement_id": 18
}
```

**Ответ**

`//Empty, status = 200`

---

### Получить достижения пользователя

- **URL**: `/achievements/{user_id}`
- **Метод**: `GET`
- **Описание**: Возвращает список достижений пользователя.

**Параметры пути**:

- `user_id` - ID пользователя

**Ответ**:

```json
[
    {
        "id": 1,
        "score": 50,
        "translation": {
            "language": "EN",
            "title": "Achievement Title",
            "description": "Achievement Description"
        }
    }
    // другие достижения
]
```

---

## Статистика

### Пользователь с максимальным количеством достижений

- **URL**: `/statistics/max_achievements`
- **Метод**: `GET`
- **Описание**: Возвращает пользователя с наибольшим количеством достижений.

**Ответ**:

```json
{
    "user": {/* информация о пользователе */},
    "count": 10
}
```

---

### Пользователь с максимальным общим счетом

- **URL**: `/statistics/max_score`
- **Метод**: `GET`
- **Описание**: Возвращает пользователя с наибольшим общим счетом.

**Ответ**:

```json
{/* информация о пользователе */}
```

---

### Пользователи с максимальной разницей в счетах

- **URL**: `/statistics/max_diff`
- **Метод**: `GET`
- **Описание**: Возвращает список пользователей с максимальной разницей в счетах.

**Ответ**:

```json
[/* список пользователей */]
```

---

### Пользователи с минимальной разницей в счетах

- **URL**: `/statistics/min_diff`
- **Метод**: `GET`
- **Описание**: Возвращает список пользователей с минимальной разницей в счетах.

**Ответ**:

```json
[/* список пользователей */]
```

---

### Пользователи с серией достижений

- **URL**: `/statistics/streak`
- **Метод**: `GET`
- **Описание**: Возвращает пользователей с серией достижений за последние 7 дней.

**Параметры запроса**:

- `limit` (необязательный, по умолчанию 10) - максимальное количество пользователей

**Ответ**:

```json
[/* список пользователей */]
```